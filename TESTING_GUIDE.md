# 🧪 ボイスタスクモード改善機能テストガイド

## 📋 テスト準備

### 必要な環境
- Android 6.0以降 または iOS 12.0以降のデバイス
- マイク機能が正常に動作するデバイス
- インターネット接続（音声認識API使用のため）

### 権限設定
1. **Android**: マイク、ストレージ権限を許可
2. **iOS**: マイク使用許可を設定
3. **通知**: アプリからの通知を許可（エラー表示のため）

## 🎯 基本機能テスト

### テスト1: アプリ起動と初期化
1. アプリを起動
2. ボイスメモタブを選択
3. 画面上部の状態表示を確認

**期待結果:**
- ✅ 「拡張版」または「標準版」のバッジが表示される
- ✅ 初期化エラーがない場合、録音ボタンが有効になる

### テスト2: 短時間録音（基本動作確認）
1. 録音ボタンをタップ
2. 5-10秒間話す
3. 停止ボタンをタップ

**期待結果:**
- ✅ 録音中にリアルタイムで書き起こしが表示される
- ✅ 録音停止後にボイスメモが保存される
- ✅ 書き起こしテキストが正確に記録される

## 🔄 連続音声認識テスト

### テスト3: 長時間録音（30秒以上）
1. 録音ボタンをタップ
2. 30秒以上連続で話し続ける
3. 途中で2-3秒の無音を入れる
4. 再び話し続ける

**期待結果:**
- ✅ 30秒経過後も録音が継続される
- ✅ 無音後に自動的に音声認識が再開される
- ✅ 書き起こしテキストが途切れずに更新される

### テスト4: 無制限録音テスト
1. 録音を開始
2. 1分以上の長時間録音を実行
3. 意図的に無音時間を作る（5秒程度）
4. 再び話し始める

**期待結果:**
- ✅ 1分以上の録音が可能
- ✅ 無音後の自動再開が動作する
- ✅ 「音声認識を自動的に再開しました」の通知が表示される

## 🛠️ サービス切り替えテスト

### テスト5: 拡張サービス動作確認
1. アプリ起動時に「拡張版」バッジが表示されることを確認
2. 録音を開始
3. 状態表示で拡張機能の動作を確認

**期待結果:**
- ✅ 「拡張版使用中」の表示
- ✅ より安定した音声認識
- ✅ Keep-aliveメカニズムの動作

### テスト6: フォールバック機能テスト
1. 拡張サービスが利用できない環境をシミュレート
2. 標準サービスへの自動切り替えを確認

**期待結果:**
- ✅ 「標準版」バッジの表示
- ✅ エラーなく標準サービスで動作

## ⚠️ エラーハンドリングテスト

### テスト7: ネットワーク切断テスト
1. 録音を開始
2. Wi-Fi/モバイルデータを無効にする
3. 音声認識エラーの発生を確認
4. ネットワークを復旧
5. 自動回復を確認

**期待結果:**
- ✅ ネットワークエラーの適切な表示
- ✅ ネットワーク復旧後の自動再試行
- ✅ 最大5回までの再試行実行

### テスト8: 権限拒否テスト
1. アプリ設定でマイク権限を無効にする
2. 録音を試行
3. 権限エラーの表示を確認

**期待結果:**
- ✅ 「マイクの権限が必要です」のメッセージ表示
- ✅ 設定画面への誘導

## 📱 プラットフォーム固有テスト

### Android固有テスト
1. **バックグラウンド動作**: ホームボタンを押して他アプリに切り替え
2. **通知**: 録音中の通知表示確認
3. **省電力モード**: バッテリー最適化設定での動作確認

### iOS固有テスト
1. **App切り替え**: アプリスイッチャーでの動作確認
2. **コントロールセンター**: 録音中のコントロールセンター操作
3. **通話割り込み**: 通話着信時の動作確認

## 🔍 詳細動作確認

### テスト9: リアルタイム書き起こし精度
1. 明瞭に話す
2. 早口で話す
3. 小声で話す
4. 雑音がある環境で話す

**期待結果:**
- ✅ 各条件での書き起こし精度を確認
- ✅ リアルタイム更新の遅延確認

### テスト10: メモリ・パフォーマンステスト
1. 長時間録音（5分以上）
2. 複数回の録音・停止を繰り返し
3. アプリのメモリ使用量を監視

**期待結果:**
- ✅ メモリリークがない
- ✅ アプリがクラッシュしない
- ✅ 動作速度が低下しない

## 📊 テスト結果記録

### テスト結果シート

| テスト項目 | 実行日時 | 結果 | 備考 |
|------------|----------|------|------|
| 基本録音 | _____ | ✅/❌ | _____ |
| 長時間録音 | _____ | ✅/❌ | _____ |
| 自動再開 | _____ | ✅/❌ | _____ |
| エラー回復 | _____ | ✅/❌ | _____ |
| サービス切り替え | _____ | ✅/❌ | _____ |

### 問題報告フォーマット

```
【問題タイトル】: 
【発生条件】: 
【期待動作】: 
【実際の動作】: 
【デバイス情報】: 
【OS版本】: 
【再現手順】: 
1. 
2. 
3. 
```

## 🚀 パフォーマンス指標

### 測定項目
- **録音開始時間**: ボタンタップから録音開始まで
- **書き起こし遅延**: 発話から表示まで
- **自動再開時間**: 停止検知から再開まで
- **メモリ使用量**: 長時間使用時の増加量
- **バッテリー消費**: 1時間録音での消費量

### 目標値
- 録音開始: 2秒以内
- 書き起こし遅延: 3秒以内
- 自動再開: 1秒以内
- メモリ増加: 50MB以内/時間
- バッテリー消費: 20%以内/時間

## 🎯 合格基準

### 必須項目（すべて合格必要）
- ✅ 基本録音機能が正常動作
- ✅ 30秒以上の連続録音が可能
- ✅ 自動再開メカニズムが動作
- ✅ エラー時の適切な通知表示
- ✅ アプリがクラッシュしない

### 推奨項目（80%以上合格）
- ✅ リアルタイム書き起こしの精度
- ✅ ネットワークエラーからの自動回復
- ✅ 長時間使用時の安定性
- ✅ バッテリー効率
- ✅ メモリ効率

## 📞 サポート情報

### トラブルシューティング
1. **録音が開始されない**: 権限設定を確認
2. **書き起こしが表示されない**: ネットワーク接続を確認
3. **自動再開しない**: アプリを再起動
4. **音質が悪い**: マイクの清掃、周囲の雑音確認

### 既知の制限事項
- Web版では一部機能が制限される
- 古いデバイスでは性能が劣る場合がある
- ネットワーク環境により精度が変動する

このテストガイドに従って実機テストを実行することで、実装した連続音声認識機能の動作を包括的に確認できます。